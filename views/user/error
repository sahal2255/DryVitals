<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description"
		content="Responsive Bootstrap4 Shop Template, Created by Imran Hossain from https://imransdesign.com/">

	<!-- title -->
	<title>Shop</title>
	<style>
		.sorting-filtering {
			background-color: #ffffff;
			padding: 20px;
			border-radius: 5px;
			margin-bottom: 20px;
		}

		.sorting-filtering h4 {
			font-size: 18px;
			margin-bottom: 10px;
		}

		.sorting-filtering select {
			width: 50%;
			padding: 8px;
			border-radius: 5px;
			border: 1px solid #ccc;
			outline: none;
			font-size: 14px;
			margin-top: 5px;
		}

		.sorting-filtering select:focus {
			border-color: #999;
		}

		.single-product-item {
			position: relative;
			margin-bottom: 30px;
			/* Adjust as needed */
		}

		.product-image-container {
			position: relative;
		}

		.wishlist-btn {
			position: absolute;
			top: 10px;
			right: 10px;
			z-index: 1;
			color: #9a9696;
			font-size: 20px;
			text-decoration: none;
			/*  background-color: transparent;*/
			border: none;
			cursor: pointer;
		}


		.wishlist-btn i {
			vertical-align: middle;
		}

		.added-to-wishlist .bi-heart-fill {
			color: red;
		}

		.filter-btn-container {
			text-align: center;
		}

		.filter-btn {
			padding: 5px 10px;
			border: 1px solid #db7924;
			border-radius: 30px;
			height: 60px;
			width: 100px;
			cursor: pointer;
			color: black;
			transition: background-color 0.3s;
			margin-right: 10px;
			margin-bottom: 20px;
		}

		.filter-btn a {
			color: #040404;
			/* Anchor text color */
			text-decoration: none;
			font-size: 15px;

		}

		.filter-btn:hover {
			background-color: #db7924;
			color: white;
			font-size: 16px;
		}

		.filter-btn:hover a {
			color: #f9f9f9;
		}

		.main {
			margin-top: 50px;
		}
	</style>

	<!-- favicon -->
	{{!--
	<link rel="shortcut icon" type="image/png" href="/assets/img/favicon.png"> --}}

	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
	<!-- google font -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Poppins:400,700&display=swap" rel="stylesheet">
	<!-- fontawesome -->
	<link rel="stylesheet" href="/assets/css/all.min.css">
	<!-- bootstrap -->
	<link rel="stylesheet" href="/assets/bootstrap/css/bootstrap.min.css">
	<!-- owl carousel -->
	<link rel="stylesheet" href="/assets/css/owl.carousel.css">
	<!-- magnific popup -->
	<link rel="stylesheet" href="/assets/css/magnific-popup.css">
	<!-- animate css -->
	<link rel="stylesheet" href="/assets/css/animate.css">
	<!-- mean menu css -->
	<link rel="stylesheet" href="/assets/css/meanmenu.min.css">
	<!-- main style -->
	<link rel="stylesheet" href="/assets/css/main.css">
	<!-- responsive -->
	<link rel="stylesheet" href="/assets/css/responsive.css">

</head>

<body>

	<!--PreLoader-->
	{{!-- <div class="loader">
		<div class="loader-inner">
			<div class="circle"></div>
		</div>
	</div> --}}
	<!--PreLoader Ends-->

	<!-- header -->
	<div class="top-header-area" id="sticker">
		<div class="container">
			<div class="row">
				<div class="col-lg-12 col-sm-12 text-center">
					<div class="main-menu-wrap">
						<!-- logo -->
						<div class="site-logo">
							<a href="index.hbs">
								<img src="/assets/img/Mainlogo.png" alt="">
							</a>
						</div>
						<!-- logo -->

						<!-- menu start -->
						<nav class="main-menu">
							<ul>
								<li class="current-list-item"><a href="/">Home</a>
									<ul class="sub-menu">
										<li><a href="index.html">Static Home</a></li>
										<li><a href="index_2.html">Slider Home</a></li>
									</ul>
								</li>
								<li><a href="/product">Product</a></li>
								<li><a href="#">Pages</a>
									<ul class="sub-menu">
										<li><a href="404.html">404 page</a></li>
										<li><a href="about.html">About</a></li>
										<li><a href="cart.html">Cart</a></li>
										<li><a href="checkout.html">Check Out</a></li>
										<li><a href="contact.html">Contact</a></li>
										<li><a href="/product">Product</a></li>
										<li><a href="/login">Login</a></li>
									</ul>
								</li>
								<li><a href="news.html">News</a>
									<ul class="sub-menu">
										<li><a href="news.html">News</a></li>
										<li><a href="single-news.html">Single News</a></li>
									</ul>
								</li>
								<li><a href="contact.html">Contact</a></li>
								<li><a href="shop.html">Shop</a>
									<ul class="sub-menu">
										<li><a href="/product">Product</a></li>
										<li><a href="checkout.html">Check Out</a></li>
										{{!-- <li><a href="/singleProduct">Single Product</a></li> --}}
										<li><a href="/cart">Cart</a></li>
									</ul>
								</li>
								<li>
									<div class="header-icons">
										<a class="mobile-hide search-bar-icon" href="#" id="search-icon"><i
												class="fas fa-search"></i></a>
										<a class="shopping-cart" href="/cart"><i class="fas fa-shopping-cart"></i></a>
										<a class="mobile-hide wishlist-bar-icon" href="/wishlist"><i
												class="bi bi-heart-fill"></i></a>
										<a class="mobile-hide person-bar-icon" href="/profile"><i
												class="bi bi-person-circle"></i></a>
									</div>

								</li>

							</ul>
						</nav>
						<a class="mobile-show search-bar-icon" href="#"><i class="fas fa-search"></i></a>
						<div class="mobile-menu"></div>
						<!-- menu end -->
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end header -->

	<!-- search area -->
	<div class="search-area" id="search-area">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<span class="close-btn"><i class="fas fa-window-close"></i></span>
					<div class="search-bar">
						<div class="search-bar-tablecell">
							<h3>Search For:</h3>
							<input type="text" id="search-input" placeholder="Keywords">
							<button type="button" id="search-button">Search <i class="fas fa-search"></i></button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end search arewa -->

	<!-- breadcrumb-section -->
	<div class="breadcrumb-section breadcrumb-bg">
		<div class="container">
			<div class="row">
				<div class="col-lg-8 offset-lg-2 text-center">
					<div class="breadcrumb-text">
						<p>Fresh and Organic</p>
						<h1>Shop</h1>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end breadcrumb section -->

	<!-- products -->
	<div class="main">

		<div class="row">
			<div class="col-md-12 filter-btn-container">
				<button class="filter-btn"><a href="/product">All</a></button>
				{{#each category}}
				<button class="filter-btn " data-category="{{this}}">
					<a href="/product?category={{this}}">{{this}}</a>
				</button>
				{{/each}}
			</div>
		</div>
	</div>
	<div class="sortdiv">
		<div class="sorting-filtering">
			<div class="container">
				{{!-- <h4>Sort By</h4> --}}
				<select id="sortSelect">
					<option value="default">Default</option>
					<option value="price-low-high"> Low to High</option>
					<option value="price-high-low"> High to Low</option>
				</select>
			</div>
		</div>
	</div>


	{{!-- ----product section starting --}}
	<div class="product-section mt-150 mb-150">
		<div class="container">
			<div class="products-lists">
				<div class="row product-lists">

					{{#each products}}
					<div class="col-lg-4 col-md-6 text-center">
						<div class="single-product-item" data-filter="{{category}}">
							<div class="product-image">
								<a href="/singleProduct/{{_id}}"><img src="{{imageUrl}}" alt="productimage"
										style="width: 200px ;height: 200px;;"></a>
								{{!-- <a href="#" class="wishlist-btn"><i class="bi bi-heart-fill"></i></a> --}}

							</div>
							<h3>{{productName}}</h3>
							{{#if isDisabled}}
							<h5 style="color: red;">Out of stock</h5>
							{{/if}}
							
							<p class="product-price"> ₹{{stock.[0].price}}</p>
							<del class="product-mrp">₹{{stock.[0].mrp}}</del>

							<p class="product-variant"> {{stock.[0].variant}}</p>
							<p class="product-category"> {{category}}</p>
							<div class="stock-details">
								<label for="stockSelect{{_id}}">Choose</label>
								<select id="stockSelect{{_id}}" name="stockSelect{{_id}}"
									onchange="updateProductDetails('{{_id}}', this)" style="width:80px">
									{{#each stock}}
									<option value="{{variant}}" data-price="{{price}}" data-stock="{{stock}}" data-mrp="{{mrp}}" {{#if
										@first}} selected{{/if}}>{{variant}}</option>
									{{/each}}
								</select>
							</div>
							{{!-- <button class="wishlist-btn{{#if inWishlist}} added-to-wishlist{{/if}}"
								data-product-id="{{_id}}" data-product-image="{{imageUrl}}"
								data-product-name="{{productName}}" data-product-price="{{stock.[0].price}}"
								data-product-variant="{{stock.[0].variant}}">
								<i class="bi bi-heart-fill"></i>
							</button> --}}

{{#if inWishlist}}
		<a href="#" class="wishlist-btn" style="color: red;"><i class="bi bi-heart-fill"></i> Added to Wishlist</a>
		{{else}}
		<a href="#" class="wishlist-btn" onclick="addToWishlist('{{_id}}', this)"><i class="bi bi-heart"></i> Add to Wishlist</a>
		{{/if}}
						</div>
					</div>
					{{/each}}

				</div>

			</div>
</div>
</div>





			<!-- footer -->
			<div class="footer-area">
				<div class="container">
					<div class="row">
						<div class="col-lg-3 col-md-6">
							<div class="footer-box about-widget">
								<h2 class="widget-title">About us</h2>
								<p>Ut enim ad minim veniam perspiciatis unde omnis iste natus error sit voluptatem
									accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae.</p>
							</div>
						</div>
						<div class="col-lg-3 col-md-6">
							<div class="footer-box get-in-touch">
								<h2 class="widget-title">Get in Touch</h2>
								<ul>
									<li>34/8, East Hukupara, Gifirtok, Sadan.</li>
									<li>support@fruitkha.com</li>
									<li>+00 111 222 3333</li>
								</ul>
							</div>
						</div>
						<div class="col-lg-3 col-md-6">
							<div class="footer-box pages">
								<h2 class="widget-title">Pages</h2>
								<ul>
									<li><a href="index.html">Home</a></li>
									<li><a href="about.html">About</a></li>
									<li><a href="services.html">Shop</a></li>
									<li><a href="news.html">News</a></li>
									<li><a href="contact.html">Contact</a></li>
								</ul>
							</div>
						</div>
						<div class="col-lg-3 col-md-6">
							<div class="footer-box subscribe">
								<h2 class="widget-title">Subscribe</h2>
								<p>Subscribe to our mailing list to get the latest updates.</p>
								<form action="index.html">
									<input type="email" placeholder="Email">
									<button type="submit"><i class="fas fa-paper-plane"></i></button>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- end footer -->

			<!-- copyright -->
			<div class="copyright">
				<div class="container">
					<div class="row">
						<div class="col-lg-6 col-md-12">
							<p>Copyrights &copy; 2019 - <a href="https://imransdesign.com/">Imran Hossain</a>, All
								Rights Reserved.</p>
						</div>
						<div class="col-lg-6 text-right col-md-12">
							<div class="social-icons">
								<ul>
									<li><a href="#" target="_blank"><i class="fab fa-facebook-f"></i></a></li>
									<li><a href="#" target="_blank"><i class="fab fa-twitter"></i></a></li>
									<li><a href="#" target="_blank"><i class="fab fa-instagram"></i></a></li>
									<li><a href="#" target="_blank"><i class="fab fa-linkedin"></i></a></li>
									<li><a href="#" target="_blank"><i class="fab fa-dribbble"></i></a></li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- end copyright -->
			<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
			<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
			<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
				integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
				crossorigin="anonymous"></script>
			<script>
				function updateProductDetails(productId, selectElement) {
					// Get the selected variant option
					var selectedOption = selectElement.options[selectElement.selectedIndex];

					// Get the selected variant details
					var selectedVariant = selectedOption.getAttribute('value');
					var selectedPrice = selectedOption.getAttribute('data-price');
					var selectedmrp = selectedOption.getAttribute('data-mrp');

					//var selectedStock = selectedOption.getAttribute('data-stock');

					// Update the product details displayed on the page
					var priceElement = selectElement.parentElement.parentElement.querySelector('.product-price');
					var variantElement = selectElement.parentElement.parentElement.querySelector('.product-variant');
					var mrpElement = selectElement.parentElement.parentElement.querySelector('.product-mrp');

					//var stockElement = selectElement.parentElement.parentElement.querySelector('.product-stock');

					priceElement.textContent = '₹' + selectedPrice;
					mrpElement.textContent = '₹' + selectedmrp;

					variantElement.textContent = ' ' + selectedVariant;
					//stockElement.textContent =' ' + selectedStock;
				}


				document.addEventListener('DOMContentLoaded', function () {
					const sortSelect = document.getElementById('sortSelect');

					sortSelect.addEventListener('change', function (e) {
						const selectedValue = e.target.value;
						console.log('selected value',selectedValue);

						axios.post('/product/sortProducts', {
							sortBy: selectedValue
						})
							.then(response => {
								console.log('server response:', response.data);
								renderProducts(response.data.products)

							})
							.catch(error => {
								console.log('error', error);
							});
					});

				});
function renderProducts(products) {
    const productsContainer = document.querySelector('.product-lists');
//    productsContainer.innerHTML = '';
    products.forEach(product => {
        const outOfStockMessage = product.isDisabled ? '<h5 style="color: red;">Out of stock</h5>' : '';

        const productHTML = `
            <div class="col-lg-4 col-md-6 text-center">
                <div class="single-product-item" data-filter="${product.category}">
                    <div class="product-image">
                        <a href="/singleProduct/${product._id}"><img src="${product.imageUrl}" alt="productimage" style="width: 200px; height: 200px;"></a>
                    </div>
                    <h3>${product.productName}</h3>
                    ${outOfStockMessage}
                    <p class="product-price">₹${product.stock[0].price}</p>
                    <del class="product-mrp">₹${product.stock[0].mrp}</del>
                    <p class="product-variant">${product.stock[0].variant}</p>
                    <p class="product-category">${product.category}</p>
                    <div class="stock-details">
                        <label for="stockSelect${product._id}">Choose</label>
                        <select id="stockSelect${product._id}" name="stockSelect${product._id}" onchange="updateProductDetails('${product._id}', this)" style="width:80px">
                            ${product.stock.map(stockItem => `
                                <option value="${stockItem.variant}" data-price="${stockItem.price}" data-stock="${stockItem.stock}" data-mrp="${stockItem.mrp}" ${stockItem === product.stock[0] ? 'selected' : ''}>${stockItem.variant}</option>
                            `).join('')}
                        </select>
                    </div>
                    <button class="wishlist-btn${product.inWishlist ? ' added-to-wishlist' : ''}" data-product-id="${product._id}" data-product-image="${product.imageUrl}" data-product-name="${product.productName}" data-product-price="${product.stock[0].price}" data-product-variant="${product.stock[0].variant}">
                        <i class="bi bi-heart-fill"></i>
                    </button>
                </div>
            </div>`;
        
        productsContainer.insertAdjacentHTML('beforeend', productHTML);
    });
}




const wishlistItems = JSON.parse(localStorage.getItem('wishlist')) || {};
const wishlistButtons = document.querySelectorAll('.wishlist-btn');
					wishlistButtons.forEach(button => {
						button.addEventListener('click', function (event) {
							const productId = button.dataset.productId;
							const productImage = button.dataset.productImage;
							const productName = button.dataset.productName;
							const productPrice = button.dataset.productPrice;
							const productVariant = button.dataset.productVariant;
							//console.log('productId', productId);
							//console.log('productImage', productImage);
							// console.log('productName', productName);
							//console.log('productPrice', productPrice);
							//console.log('productVariant', productVariant);
							addToWishlist(productId, productImage, productName, productPrice, productVariant);
						});
					});
			

				function addToWishlist(productId, productImage, productName, productPrice, productVariant) {
					axios.post('/wishlist/add', {
						productId: productId,
						productImage: productImage,
						productName: productName,
						productPrice: productPrice,
						productVariant: productVariant
					})
						.then(response => {
							console.log('Product added to wishlist:', response.data);
							document.querySelector(`.wishlist-btn[data-product-id="${productId}"]`).classList.add('added-to-wishlist');
							const wishlistItems = JSON.parse(localStorage.getItem('wishlist')) || {};
							wishlistItems[productId] = true;
							localStorage.setItem('wishlist', JSON.stringify(wishlistItems));
							Toastify({
								text: 'Product added to wishlist',
								duration: 3000,
								gravity: 'bottom',
								backgroundColor: 'green',
							}).showToast();
						})
						.catch(error => {
							console.error('Error adding product to wishlist:', error);
							// Show error toast
							Toastify({
								text: 'Error adding product to wishlist',
								duration: 3000,
								gravity: 'bottom',
								backgroundColor: 'red',
							}).showToast();
						});
				}




			</script>
			<!-- //If you're using CDN -->
			<script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

			<!-- jquery -->
			<script src="/assets/js/jquery-1.11.3.min.js"></script>
			<!-- bootstrap -->
			<script src="/assets/bootstrap/js/bootstrap.min.js"></script>
			<!-- count down -->
			<script src="/assets/js/jquery.countdown.js"></script>
			<!-- isotope -->
			<script src="/assets/js/jquery.isotope-3.0.6.min.js"></script>
			<!-- waypoints -->
			<script src="/assets/js/waypoints.js"></script>
			<!-- owl carousel -->
			<script src="/assets/js/owl.carousel.min.js"></script>
			<!-- magnific popup -->
			<script src="/assets/js/jquery.magnific-popup.min.js"></script>
			<!-- mean menu -->
			<script src="/assets/js/jquery.meanmenu.min.js"></script>
			<!-- sticker js -->
			<script src="/assets/js/sticker.js"></script>
			<!-- main js -->
			<script src="/assets/js/main.js"></script>

</body>

</html>